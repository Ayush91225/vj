# Production Deployment Guide\n\nComplete guide for deploying VajraOpz to production with Vercel (frontend) and AWS (backend).\n\n## ğŸ—ï¸ Architecture Overview\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   Vercel        â”‚    â”‚   AWS API       â”‚    â”‚   AWS Lambda    â”‚\nâ”‚   (Frontend)    â”‚â”€â”€â”€â–¶â”‚   Gateway        â”‚â”€â”€â”€â–¶â”‚   (GraphQL)     â”‚\nâ”‚   React App     â”‚    â”‚   (HTTPS)        â”‚    â”‚   Python        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                                         â”‚\n                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚\n                       â”‚   DynamoDB      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                       â”‚   (Database)    â”‚\n                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                â”‚\n                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                       â”‚   ECS Fargate   â”‚\n                       â”‚   (AI Agents)   â”‚\n                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## ğŸš€ Step 1: Setup GitHub OAuth App\n\n1. **Create GitHub OAuth App:**\n   - Go to [GitHub Developer Settings](https://github.com/settings/developers)\n   - Click \"New OAuth App\"\n   - Configure:\n     - **Application name**: `VajraOpz`\n     - **Homepage URL**: `https://vajraopz.vercel.app`\n     - **Authorization callback URL**: `https://vajraopz.vercel.app/auth/callback`\n\n2. **Save Credentials:**\n   ```bash\n   export GITHUB_CLIENT_ID=your_client_id\n   export GITHUB_CLIENT_SECRET=your_client_secret\n   ```\n\n## ğŸ”§ Step 2: Deploy AWS Backend\n\n1. **Prerequisites:**\n   ```bash\n   # Install required tools\n   brew install terraform awscli sam-cli\n   \n   # Configure AWS CLI\n   aws configure\n   ```\n\n2. **Deploy Infrastructure:**\n   ```bash\n   cd backend\n   ./deploy.sh\n   ```\n\n3. **Note the API Gateway URL:**\n   ```bash\n   # After deployment, save this URL\n   API_URL=$(aws cloudformation describe-stacks \\\n     --stack-name \"sam-app\" \\\n     --query 'Stacks[0].Outputs[?OutputKey==`ApiUrl`].OutputValue' \\\n     --output text)\n   echo \"API URL: $API_URL\"\n   ```\n\n## ğŸŒ Step 3: Deploy Frontend to Vercel\n\n1. **Update Backend Configuration:**\n   ```bash\n   # Update src/config/backend.js with your API Gateway URL\n   export const backendConfig = {\n     apiUrl: 'https://your-api-id.execute-api.us-east-1.amazonaws.com/prod/graphql',\n     // ... rest of config\n   };\n   ```\n\n2. **Deploy to Vercel:**\n   ```bash\n   # Install Vercel CLI\n   npm i -g vercel\n   \n   # Login to Vercel\n   vercel login\n   \n   # Deploy\n   vercel --prod\n   ```\n\n3. **Set Environment Variables in Vercel:**\n   ```bash\n   # Via Vercel CLI\n   vercel env add VITE_API_BASE_URL\n   # Enter your API Gateway URL\n   \n   vercel env add VITE_ENVIRONMENT\n   # Enter: production\n   ```\n\n   Or via Vercel Dashboard:\n   - Go to Project Settings â†’ Environment Variables\n   - Add:\n     - `VITE_API_BASE_URL`: Your API Gateway URL\n     - `VITE_ENVIRONMENT`: `production`\n\n## ğŸ¤– Step 4: Configure AI Agent API Keys\n\n1. **Get API Keys:**\n   - **OpenRouter**: [openrouter.ai](https://openrouter.ai)\n   - **Anthropic**: [console.anthropic.com](https://console.anthropic.com)\n   - **Google**: [ai.google.dev](https://ai.google.dev)\n   - **Sarvam**: [sarvam.ai](https://sarvam.ai)\n   - **Codeium**: [codeium.com](https://codeium.com)\n\n2. **Store in AWS Systems Manager:**\n   ```bash\n   aws ssm put-parameter \\\n     --name \"/vajraopz/prod/openrouter/api_key\" \\\n     --value \"your_openrouter_key\" \\\n     --type \"SecureString\"\n   \n   aws ssm put-parameter \\\n     --name \"/vajraopz/prod/anthropic/api_key\" \\\n     --value \"your_anthropic_key\" \\\n     --type \"SecureString\"\n   \n   # Repeat for other API keys...\n   ```\n\n## ğŸ”’ Step 5: Security Configuration\n\n1. **Update CORS Settings:**\n   ```bash\n   # Update API Gateway CORS to allow Vercel domain\n   aws apigateway update-rest-api \\\n     --rest-api-id your-api-id \\\n     --patch-ops op=replace,path=/cors/allowOrigin,value=https://vajraopz.vercel.app\n   ```\n\n2. **Configure CSP Headers:**\n   - Already configured in `vercel.json`\n   - Includes security headers for production\n\n## ğŸ“Š Step 6: Monitoring Setup\n\n1. **CloudWatch Dashboards:**\n   ```bash\n   # Create monitoring dashboard\n   aws cloudwatch put-dashboard \\\n     --dashboard-name \"VajraOpz-Production\" \\\n     --dashboard-body file://monitoring/dashboard.json\n   ```\n\n2. **Vercel Analytics:**\n   - Enable in Vercel Dashboard\n   - Monitor frontend performance\n\n## ğŸ§ª Step 7: Testing Production Deployment\n\n1. **Test Authentication Flow:**\n   ```bash\n   # Test GitHub OAuth\n   curl -X POST https://your-api.execute-api.us-east-1.amazonaws.com/prod/graphql \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"query\": \"query { githubAuth { url state } }\"}'\n   ```\n\n2. **Test Agent Execution:**\n   - Create a test project via frontend\n   - Trigger agent execution\n   - Verify results in S3 bucket\n\n## ğŸ”„ Step 8: CI/CD Pipeline (Optional)\n\n1. **GitHub Actions for Backend:**\n   ```yaml\n   # .github/workflows/deploy-backend.yml\n   name: Deploy Backend\n   on:\n     push:\n       branches: [main]\n       paths: ['backend/**']\n   \n   jobs:\n     deploy:\n       runs-on: ubuntu-latest\n       steps:\n         - uses: actions/checkout@v3\n         - name: Deploy to AWS\n           run: |\n             cd backend\n             ./deploy.sh\n           env:\n             AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}\n             AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n             GITHUB_CLIENT_ID: ${{ secrets.GITHUB_CLIENT_ID }}\n             GITHUB_CLIENT_SECRET: ${{ secrets.GITHUB_CLIENT_SECRET }}\n   ```\n\n2. **Vercel Auto-Deploy:**\n   - Automatically deploys on push to main branch\n   - No additional configuration needed\n\n## ğŸ“‹ Production Checklist\n\n- [ ] GitHub OAuth app created with production URLs\n- [ ] AWS infrastructure deployed successfully\n- [ ] API Gateway URL obtained and configured\n- [ ] Frontend deployed to Vercel\n- [ ] Environment variables set in Vercel\n- [ ] AI agent API keys configured in AWS SSM\n- [ ] CORS settings updated for production domain\n- [ ] Security headers configured\n- [ ] Monitoring and logging enabled\n- [ ] Production testing completed\n\n## ğŸŒ Custom Domain (Optional)\n\n1. **Add Custom Domain to Vercel:**\n   ```bash\n   vercel domains add yourdomain.com\n   ```\n\n2. **Update GitHub OAuth App:**\n   - Change URLs to use your custom domain\n   - Update CORS settings accordingly\n\n## ğŸ“ Production URLs\n\nAfter deployment, your production URLs will be:\n- **Frontend**: `https://vajraopz.vercel.app`\n- **API**: `https://your-api-id.execute-api.us-east-1.amazonaws.com/prod/graphql`\n- **GitHub OAuth Callback**: `https://vajraopz.vercel.app/auth/callback`\n\n## ğŸ†˜ Troubleshooting\n\n### Common Issues:\n\n1. **CORS Errors:**\n   ```bash\n   # Update API Gateway CORS\n   aws apigateway update-rest-api --rest-api-id YOUR_API_ID \\\n     --patch-ops op=replace,path=/cors/allowOrigin,value=https://vajraopz.vercel.app\n   ```\n\n2. **Authentication Failures:**\n   - Verify GitHub OAuth app URLs\n   - Check SSM parameters are set correctly\n   - Ensure API Gateway has correct permissions\n\n3. **Agent Execution Timeouts:**\n   - Check ECS task logs in CloudWatch\n   - Verify API keys are configured\n   - Increase Lambda timeout if needed\n\n## ğŸ’° Cost Optimization\n\n- **Vercel**: Free tier for personal projects\n- **AWS**: Pay-per-use with DynamoDB on-demand\n- **ECS Fargate**: Only pay when agents are running\n- **Lambda**: Pay per request\n\nEstimated monthly cost for moderate usage: $10-50\n\n---\n\n**ğŸ‰ Your VajraOpz platform is now live in production!**\n\nAccess it at: `https://vajraopz.vercel.app`