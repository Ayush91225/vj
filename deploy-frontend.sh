#!/bin/bash\n\nset -e\n\necho \"\ud83d\ude80 Deploying VajraOpz Frontend to Vercel...\"\n\n# Check if API URL is provided\nif [ -z \"$1\" ]; then\n    echo \"\u26a0\ufe0f  Please provide the API Gateway URL as first argument\"\n    echo \"Usage: ./deploy-frontend.sh https://your-api-id.execute-api.us-east-1.amazonaws.com/prod/graphql\"\n    exit 1\nfi\n\nAPI_URL=$1\n\n# Update backend configuration\necho \"\ud83d\udd27 Updating backend configuration...\"\ncat > src/config/backend.js << EOF\n// Backend configuration for production deployment\nexport const backendConfig = {\n  apiUrl: '$API_URL',\n  githubOAuthUrl: 'https://github.com/login/oauth/authorize',\n  environment: 'prod',\n  region: 'us-east-1',\n  frontendUrl: 'https://vajraopz.vercel.app',\n  callbackUrl: 'https://vajraopz.vercel.app/auth/callback'\n};\n\n// GraphQL queries\nexport const GRAPHQL_QUERIES = {\n  GITHUB_AUTH: \\`\n    query githubAuth {\n      githubAuth {\n        url\n        state\n      }\n    }\n  \\`,\n  \n  GITHUB_CALLBACK: \\`\n    mutation githubCallback(\\$code: String!, \\$state: String!) {\n      githubCallback(code: \\$code, state: \\$state) {\n        user {\n          id\n          username\n          email\n          avatar_url\n        }\n        token\n      }\n    }\n  \\`,\n  \n  CREATE_PROJECT: \\`\n    mutation createProject(\\$token: String!, \\$githubRepo: String!, \\$teamName: String!, \\$teamLeader: String!) {\n      createProject(token: \\$token, githubRepo: \\$githubRepo, teamName: \\$teamName, teamLeader: \\$teamLeader) {\n        id\n        status\n      }\n    }\n  \\`,\n  \n  TRIGGER_AGENT: \\`\n    mutation triggerAgent(\\$token: String!, \\$projectId: String!) {\n      triggerAgent(token: \\$token, projectId: \\$projectId) {\n        deploymentId\n        runId\n        status\n      }\n    }\n  \\`,\n  \n  GET_PROJECTS: \\`\n    query getProjects(\\$token: String!) {\n      getProjects(token: \\$token) {\n        project_id\n        github_repo\n        team_name\n        team_leader\n        status\n        created_at\n      }\n    }\n  \\`,\n  \n  GET_DEPLOYMENT: \\`\n    query getDeployment(\\$token: String!, \\$deploymentId: String!) {\n      getDeployment(token: \\$token, deploymentId: \\$deploymentId) {\n        deployment_id\n        project_id\n        status\n        created_at\n        agent_runs {\n          run_id\n          status\n          agents\n          retry_count\n          results\n        }\n      }\n    }\n  \\`\n};\nEOF\n\necho \"\u2705 Backend configuration updated\"\n\n# Install dependencies\necho \"\ud83d\udce6 Installing dependencies...\"\nnpm install\n\n# Build the project\necho \"\ud83d\udd28 Building project...\"\nnpm run build\n\n# Check if Vercel CLI is installed\nif ! command -v vercel &> /dev/null; then\n    echo \"\ud83d\udce6 Installing Vercel CLI...\"\n    npm install -g vercel\nfi\n\n# Deploy to Vercel\necho \"\ud83d\ude80 Deploying to Vercel...\"\nvercel --prod --confirm\n\n# Get deployment URL\nDEPLOYMENT_URL=$(vercel ls | grep vajraopz | head -1 | awk '{print $2}')\n\necho \"\"\necho \"\ud83c\udf89 Frontend deployed successfully!\"\necho \"\"\necho \"Production URLs:\"\necho \"- Frontend: https://vajraopz.vercel.app\"\necho \"- API: $API_URL\"\necho \"\"\necho \"Next steps:\"\necho \"1. Update GitHub OAuth app with these URLs:\"\necho \"   - Homepage URL: https://vajraopz.vercel.app\"\necho \"   - Authorization callback URL: https://vajraopz.vercel.app/auth/callback\"\necho \"2. Test the complete authentication flow\"\necho \"3. Verify agent execution works end-to-end\"\necho \"\"\necho \"Environment variables set in Vercel:\"\necho \"- VITE_API_BASE_URL: $API_URL\"\necho \"- VITE_ENVIRONMENT: production\"